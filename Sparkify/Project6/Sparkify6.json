{"paragraphs":[{"text":"%pyspark\r\nimport json\r\ndata = sc.textFile(\"s3a://anagi1project6/*.json\")\r\nfiles=data.collect()\r\nout = []\r\nart_dict = {}\r\nsong_dict = {}\r\n#mapper.py\r\nfor line in files:\r\n    line = json.loads(line)\r\n    artist = line['artist']\r\n    song = line['song']\r\n    if artist!= None:\r\n        out.append([\"A\",artist,1])\r\n    if song!=None:\r\n        out.append([\"S\",song,1])\r\n\r\n","user":"anonymous","dateUpdated":"2020-04-22T23:36:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1587569198474_-1464918949","id":"20200422-152638_658440276","dateCreated":"2020-04-22T15:26:38+0000","dateStarted":"2020-04-22T23:36:58+0000","dateFinished":"2020-04-22T23:37:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:245"},{"text":"%pyspark\nprint(out[:10])","user":"anonymous","dateUpdated":"2020-04-22T23:37:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['A', u\"Des'ree\", 1], ['S', u'You Gotta Be', 1], ['A', u'Mr Oizo', 1], ['S', u'Flat 55', 1], ['A', u'Tamba Trio', 1], ['S', u'Quem Quiser Encontrar O Amor', 1], ['A', u'The Mars Volta', 1], ['S', u'Eriatarka', 1], ['A', u'Infected Mushroom', 1], ['S', u'Becoming Insane', 1]]\n"}]},"apps":[],"jobName":"paragraph_1587573046137_-190549847","id":"20200422-163046_1272663950","dateCreated":"2020-04-22T16:30:46+0000","dateStarted":"2020-04-22T23:37:14+0000","dateFinished":"2020-04-22T23:37:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:246"},{"text":"%pyspark\n\n#reducer.py \nart_dict = {}\nsong_dict = {}\nsong = []\nartist = []\nfor i in out:\n    if i[0] == \"A\":\n        if i[1] not in art_dict:\n            art_dict[i[1]] = 1\n        else: art_dict[i[1]] += 1\n    else:    \n        if i[1] not in song_dict:\n            song_dict[i[1]] = 1\n        else: song_dict[i[1]] += 1\n            \nfor key, value in song_dict.items():\n        song.append([key, value])\n\nfor key, value in art_dict.items():\n    artist.append([key, value])\n\n\n#sorting in descending order\nsong = sorted(song, key = lambda x:x[1],reverse = True)\nartist = sorted(artist, key = lambda x:x[1],reverse = True)\n\n","user":"anonymous","dateUpdated":"2020-04-22T23:37:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1587567974530_865686687","id":"20200422-150614_208923605","dateCreated":"2020-04-22T15:06:14+0000","dateStarted":"2020-04-22T23:37:19+0000","dateFinished":"2020-04-22T23:37:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:247"},{"text":"%pyspark\n#creating out put string..\n\noutput = \"Top 10 songs:\\n\\n\"\nfor i in range(10):\n    output = output + song[i][0] + \"\\n\"\noutput += \"\\nTop 10 artists:\\n\\n\"\nfor i in range(10):\n    output = output + artist[i][0] + \"\\n\"\n    \nprint(output)","user":"anonymous","dateUpdated":"2020-04-22T23:37:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top 10 songs:\n\nYou're The One\nUndo\nRevelry\nSehr kosmisch\nHorn Concerto No. 4 in E flat K495: II. Romance (Andante cantabile)\nCanada\nSecrets\nDog Days Are Over (Radio Edit)\nInvalid\nFireflies\n\nTop 10 artists:\n\nColdplay\nKings Of Leon\nDwight Yoakam\nThe Black Keys\nMuse\nFlorence + The Machine\nJack Johnson\nBjÃÂ¶rk\nJohn Mayer\nThe Killers\n\n"}]},"apps":[],"jobName":"paragraph_1587573729675_821590758","id":"20200422-164209_2131754231","dateCreated":"2020-04-22T16:42:09+0000","dateStarted":"2020-04-22T23:37:23+0000","dateFinished":"2020-04-22T23:37:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:248"},{"text":"%pyspark\nprint(artist[:10])","user":"anonymous","dateUpdated":"2020-04-22T23:37:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[u'Coldplay', 58], [u'Kings Of Leon', 55], [u'Dwight Yoakam', 38], [u'The Black Keys', 36], [u'Muse', 35], [u'Florence + The Machine', 35], [u'Jack Johnson', 35], [u'Bj\\xc3\\x83\\xc2\\xb6rk', 33], [u'John Mayer', 31], [u'The Killers', 31]]\n"}]},"apps":[],"jobName":"paragraph_1587568246826_1580864510","id":"20200422-151046_1426335883","dateCreated":"2020-04-22T15:10:46+0000","dateStarted":"2020-04-22T23:37:34+0000","dateFinished":"2020-04-22T23:37:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:249"},{"text":"%pyspark\nprint(song[:10])","user":"anonymous","dateUpdated":"2020-04-22T23:37:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[u\"You're The One\", 37], [u'Undo', 28], [u'Revelry', 27], [u'Sehr kosmisch', 21], [u'Horn Concerto No. 4 in E flat K495: II. Romance (Andante cantabile)', 19], [u'Canada', 17], [u'Secrets', 17], [u'Dog Days Are Over (Radio Edit)', 16], [u'Invalid', 14], [u'Fireflies', 14]]\n"}]},"apps":[],"jobName":"paragraph_1587573771979_-97570911","id":"20200422-164251_1143228891","dateCreated":"2020-04-22T16:42:51+0000","dateStarted":"2020-04-22T23:37:36+0000","dateFinished":"2020-04-22T23:37:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:250"},{"text":"%pyspark\n\n#writing output string to s3 bucket..\n\nsc.parallelize(output).saveAsTextFile(\"s3a://anagi1project6/output.txt\")","user":"anonymous","dateUpdated":"2020-04-22T23:39:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1587583606737_-1891935874","id":"20200422-192646_755613991","dateCreated":"2020-04-22T19:26:46+0000","dateStarted":"2020-04-22T23:39:42+0000","dateFinished":"2020-04-22T23:39:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:251"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-04-22T23:37:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587598661339_1736515091","id":"20200422-233741_459530173","dateCreated":"2020-04-22T23:37:41+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:983"}],"name":"Sparkify6","id":"2F95NEB2K","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}